<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simpler</title>

    <style>
        li[disabled] {
            pointer-events: none;
            opacity: 0.5;
        }
    </style>
</head>
<body>
    <form action="{{ url_for('add') }}" method="post">
        <input type="text" name="task" id="">
        <input type="submit" value="Add">
    </form>

    <ul>
        {% if edit_index is defined %}
            {% for todo in todos %}
            
                {% if loop.index0 == edit_index %} 

                <li style="display: flex">
                    <form action="{{ url_for('save', index=loop.index0) }}" method="post">
                        <input type="checkbox" name="done" {% if todo['done'] %} checked {% endif %}>
                        <input type="hidden" name="done" value="not done">

                        <input type="text" name="task" id="" value="{{ todo['task'] }}">
                        <input type="submit" value="Save">
                    </form>

                    <form action="{{ url_for('save', index=loop.index0)}}" method="post">
                        
                    </form>
                    
                    <a href="{{ url_for('delete', index=loop.index0) }}">Delete</a>

                    <a href="{{ url_for('index')}}">Cancel</a>
                </li>
                {% else %}
                <li style="display: flex" disabled>
                    <form action="{{ url_for('check', index=loop.index0) }}" method="post">
                        <input type="checkbox" name="check" onchange="this.form.submit()" {% if todo['done'] %} checked {% endif %}>
                    
                    </form>

                    <text {% if todo['done'] %} style="text-decoration: line-through" {% endif %}>
                        {{ todo['task'] }}                
                    </text>


                    <a href="{{ url_for('edit', index=loop.index0) }}">Edit</a>

                    <a href="{{ url_for('delete', index=loop.index0) }}">Delete</a>

                </li>
                {% endif %}
            {% endfor %}

        {% else %}
            {% for todo in todos %}
            <li style="display: flex">
                <form action="{{ url_for('check', index=loop.index0) }}" method="post">
                    <input type="checkbox" name="check" onchange="this.form.submit()" {% if todo['done'] %} checked {% endif %}>
                
                </form>

                <text {% if todo['done'] %} style="text-decoration: line-through" {% endif %}>
                    {{ todo['task'] }}                
                </text>


                <a href="{{ url_for('edit', index=loop.index0) }}">Edit</a>

                <a href="{{ url_for('delete', index=loop.index0) }}">Delete</a>

            </li>
            
            {% endfor %}
        {% endif %}
        
        
    </ul>

</body>
</html>